# This file contains common pin mappings for the BigTreeTech Octopus
# and Octopus Pro boards. To use this config, start by identifying the
# micro-controller on the board - it may be an STM32F446, STM32F429,
# or an STM32H723.  Select the appropriate micro-controller in "make
# menuconfig" and select "Enable low-level configuration options". For
# STM32F446 boards the firmware should be compiled with a "32KiB
# bootloader" and a "12MHz crystal" clock reference. For STM32F429
# boards use a "32KiB bootloader" and an "8MHz crystal". For STM32H723
# boards use a "128KiB bootloader" and a "25Mhz crystal".

# See docs/Config_Reference.md for a description of parameters.


# MCUs configuration
[mcu] 
#restart_method: command
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_280020000F51313236343430-if00

[mcu EBB]
serial: /dev/serial/by-id/usb-Klipper_rp2040_5044506108DD901C-if00 
#canbus_uuid: 913887ca9909

[mcu scanner]
#canbus_uuid: 0ca8d67388c2 
serial: /dev/serial/by-id/usb-Cartographer_614e_020007001143304146393320-if00

#[mcu rpi]
#serial: /tmp/klipper_host_mcu

#  General Printer definition
[printer]
kinematics: corexy
max_velocity: 300 #max_accel: 10000
max_accel: 3240
#max_accel_to_decel: 5500
max_z_velocity: 15 #30
max_z_accel: 350 #350
square_corner_velocity: 5.0

[scanner]
mcu: scanner            #  Offsets are measured from the centre of your coil, to the tip of your nozzle on a level axis. It is vital that this is accurate. 
x_offset: 0             #  adjust for your cartographers offset from nozzle to middle of coil
y_offset: 15            #  adjust for your cartographers offset from nozzle to middle of coil
backlash_comp: 0.00431  #  Backlash compensation distance for removing Z backlash before measuring the sensor response.
sensor: cartographer    #  this must be set as cartographer unless using IDM etc.
sensor_alt: carto       #  alternate name to call commands. CARTO_TOUCH etc      
mesh_runs: 2            #  Number of passes to make during mesh scan.

[safe_z_home]
home_xy_position: 175, 175 # Example home_xy_position: 175,175 - This would be for a 350 * 350mm bed. 
z_hop: 10

[include mainsail.cfg]

########################################
# Probe Offset
########################################
#[probe]
#z_offset: -0.735

#max_ac
#[gcode_arcs]

# Steppers & Extruders
[include stepper_kinematics.cfg]
[include extruders.cfg]

# EBB sb2209 usb
[include EBB_sb2209_usb.cfg]

# Heaters
[include heaters.cfg]

# Pressure advance
#[include pressure_advance.cfg]

# Fans & Temps
[include fans_temps.cfg]

# Probing & Levelling & Homing
[include probe_qgl.cfg]
[include bed_mesh.cfg]
[include macro_bed_mesh_adaptive.cfg]

# Light
[include stealthburner_leds.cfg] 
[include caselight.cfg] 

# Power 
#[include power.cfg]

# Virtual SD Card
[virtual_sdcard]
path: /home/rpi/printer_data/gcodes
on_error_gcode: CANCEL_PRINT

# Macros 
[include macros.cfg]
[include nozzle_scrub.cfg]
#[include macros/calibration/calibrate.cfg]
#[include macros/calibration/pa_calibrate.cfg]
#[include macros/calibration/flow_calibrate.cfg]


#####################################################################
#	LED Control
#####################################################################

[neopixel caselight]
pin: PB10
#   The pin connected to the neopixel. This parameter must be
#   provided.
chain_count: 63
#   The number of Neopixel chips that are "daisy chained" to the
#   provided pin. The default is 1 (which indicates only a single
#   Neopixel is connected to the pin).
color_order: GRBW
#   Set the pixel order required by the LED hardware. Options are GRB,
#   RGB, GRBW, or RGBW. The default is GRB.
initial_RED: 0.0
initial_GREEN: 0.0
initial_BLUE: 0.0
initial_WHITE: 0.0
#   Sets the initial LED color of the Neopixel. Each value should be
#   between 0.0 and 1.0. The WHITE option is only available on RGBW
#   LEDs. The default for each color is 0.#

[exclude_object]

[respond]

[shaketune]
result_folder: ~/printer_data/config/ShakeTune_results
#    Path where the processed results will be stored. If the folder doesn't exist,
#    it will be automatically created. You can change this if you'd like to store 
#    results in a different location.
number_of_results_to_keep: 10
#    This setting defines how many results you want to keep in the result folder.
#    Once the specified number is exceeded, older results will be automatically deleted
#    to free up space on the SD card and avoid cluttering the results folder.
keep_raw_data: False
#    If set to True, Shake&Tune will store both the processed graphs and the raw accelerometer
#    .stdata files in the results folder. This can be useful for debugging or archiving purposes.
#    Please always attach them when reporting any issues on GitHub or Discord.
show_macros_in_webui: True
#    Mainsail and Fluidd doesn't create buttons for system commands (macros that are not part
#    of the printer.cfg file). This option allow Shake&Tune to inject them into the webui at runtime.
#    If set to False, the macros will be hidden but still accessible from the console by typing
#    their names manually, which can be useful if you prefer to encapsulate them into your own macros.
timeout: 600
#    This defines the maximum processing time (in seconds) to allows to Shake&Tune for generating 
#    graphs from a .stdata file. 10 minutes should be more than enough in most cases, but if you have
#    slower hardware (e.g., older SD cards or low-performance devices), increase it to prevent timeouts.
measurements_chunk_size: 2
#    Each Shake&Tune command uses the accelerometer to take multiple measurements. By default,
#    Shake&Tune will write a chunk of data to disk every two measurements, and at the end of the
#    command will merge these chunks into the final .stdata file for processing. "2" is a very
#    conservative setting to avoid Klipper Timer Too Close errors on lower end devices with little
#    RAM, and should work for everyone. However, if you are using a powerful computer, you may
#    wish to increase this value to keep more measurements in memory (e.g., 15-20) before writing
#    the chunk and avoid stressing the filesystem too much.
max_freq: 200
#    This setting defines the maximum frequency at which the calculation of the power spectral density
#    is cutoff. The default value should be fine for most machines and accelerometer combinations and
#    avoid touching it unless you know what you're doing.
dpi: 300
#    Controls the resolution of the generated graphs. The default value of 300 dpi was optimized
#    and strikes a balance between performance and readability, ensuring that graphs are clear
#    without using too much RAM to generate them. Usually, you shouldn't need to change this value.

[input_shaper]
shaper_freq_x: 45.2
shaper_type_x: mzv
shaper_freq_y: 32.4
shaper_type_y: mzv



#####################################################

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 2000
#*# scanner_touch_speed = 3
#*# scanner_touch_z_offset = 0.870
#*#
#*# [scanner model default]
#*# model_coef = 1.5356366685951317,
#*# 	1.8596159646198414,
#*# 	0.7399888272160335,
#*# 	0.34402349153310474,
#*# 	0.4182692240700697,
#*# 	0.3826212732488843,
#*# 	-0.31567986343111104,
#*# 	-0.36280830659618196,
#*# 	0.2724153090426942,
#*# 	0.22814445888514062
#*# model_domain = 3.190251115156734e-07,3.3052210202769064e-07
#*# model_range = 0.200000,5.100000
#*# model_temp = 44.143011
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.1.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  -0.064938, -0.069272, -0.057762, -0.052246, -0.043737, -0.023965, 0.005217, 0.028349, 0.040126, 0.035902, 0.018789, 0.006405, 0.004902, 0.004761, 0.000394, 0.000478, -0.000118, 0.000247, 0.010428, 0.031852, 0.031821, 0.007404, -0.020121, -0.028086, -0.018759, -0.006406, -0.004209, -0.006662, -0.010216, -0.014735
#*# 	  -0.047724, -0.053677, -0.040887, -0.036139, -0.030483, -0.012584, 0.014417, 0.033301, 0.041298, 0.031342, 0.014178, 0.003215, 0.000374, 0.001676, -0.001614, -0.001828, -0.001092, -0.001090, 0.006713, 0.024150, 0.026430, 0.002245, -0.025632, -0.032279, -0.027088, -0.014598, -0.009458, -0.013310, -0.021689, -0.025808
#*# 	  -0.029196, -0.035056, -0.030605, -0.028169, -0.023434, -0.007650, 0.017575, 0.034120, 0.037721, 0.028563, 0.011115, 0.001870, 0.001806, 0.003246, 0.000106, -0.000407, -0.003539, -0.002712, 0.003789, 0.021508, 0.024160, -0.000975, -0.025512, -0.031722, -0.028940, -0.026825, -0.029867, -0.029927, -0.034702, -0.038711
#*# 	  -0.022808, -0.030895, -0.028525, -0.028889, -0.026400, -0.011300, 0.014301, 0.029444, 0.033624, 0.024678, 0.007997, 0.000788, 0.003331, 0.005045, 0.001735, -0.003342, -0.006935, -0.007290, -0.001030, 0.014293, 0.019657, -0.002704, -0.025619, -0.032449, -0.029402, -0.030216, -0.038305, -0.045603, -0.050260, -0.052787
#*# 	  -0.025266, -0.032310, -0.029856, -0.032243, -0.029971, -0.013883, 0.011391, 0.027174, 0.032508, 0.024919, 0.009163, 0.003854, 0.009264, 0.011356, 0.007532, -0.000942, -0.006573, -0.007821, -0.004733, 0.010381, 0.018480, -0.000247, -0.023112, -0.027970, -0.025087, -0.029414, -0.042755, -0.055546, -0.060513, -0.063687
#*# 	  -0.028521, -0.034417, -0.031542, -0.034552, -0.033024, -0.017275, 0.010578, 0.027450, 0.032072, 0.025955, 0.010508, 0.005064, 0.011660, 0.014198, 0.007928, -0.000945, -0.008422, -0.009546, -0.004857, 0.007694, 0.015558, -0.001553, -0.021085, -0.025304, -0.022383, -0.029353, -0.047443, -0.060934, -0.068626, -0.068505
#*# 	  -0.032646, -0.035936, -0.032895, -0.035229, -0.034846, -0.018656, 0.009231, 0.029472, 0.035052, 0.028773, 0.013880, 0.007685, 0.014127, 0.019612, 0.016251, 0.005021, -0.004923, -0.008220, -0.001863, 0.010143, 0.016079, -0.000765, -0.013184, -0.016983, -0.015641, -0.028072, -0.045621, -0.062832, -0.069652, -0.070216
#*# 	  -0.032520, -0.034680, -0.030435, -0.033502, -0.034596, -0.020427, 0.008691, 0.031105, 0.036231, 0.028542, 0.013072, 0.004653, 0.009306, 0.012959, 0.007809, 0.000501, -0.007931, -0.008051, -0.003913, 0.008663, 0.015585, -0.001848, -0.017664, -0.022747, -0.022135, -0.032577, -0.049823, -0.061663, -0.071849, -0.071360
#*# 	  -0.035935, -0.036856, -0.034676, -0.033326, -0.032574, -0.016910, 0.009608, 0.033255, 0.038487, 0.030924, 0.012274, 0.002697, 0.006452, 0.010156, 0.005680, -0.001260, -0.005208, -0.005488, -0.000806, 0.012994, 0.018476, -0.000372, -0.022786, -0.031150, -0.026739, -0.034065, -0.047027, -0.059127, -0.066736, -0.062227
#*# 	  -0.036222, -0.038820, -0.033816, -0.032030, -0.030043, -0.015164, 0.013203, 0.035550, 0.040204, 0.029588, 0.010381, -0.002732, 0.000256, 0.002686, 0.001903, -0.003229, -0.006853, -0.003758, 0.002346, 0.016319, 0.020801, 0.002762, -0.020847, -0.029030, -0.029422, -0.038065, -0.056572, -0.066684, -0.069029, -0.059791
#*# 	  -0.038199, -0.039835, -0.035400, -0.032589, -0.029086, -0.012494, 0.015241, 0.037665, 0.042696, 0.031594, 0.008448, -0.006846, -0.003738, 0.000357, -0.000061, -0.001874, -0.002971, 0.001784, 0.008218, 0.020447, 0.025886, 0.008010, -0.014862, -0.025075, -0.027006, -0.040045, -0.059261, -0.069028, -0.068210, -0.055415
#*# 	  -0.035977, -0.039779, -0.033992, -0.030363, -0.024043, -0.008060, 0.019748, 0.043437, 0.044804, 0.029696, 0.005318, -0.012048, -0.008934, -0.002937, 0.000034, -0.001961, -0.002189, 0.004476, 0.008993, 0.021199, 0.027862, 0.010104, -0.012098, -0.021770, -0.024008, -0.038342, -0.061061, -0.072024, -0.068746, -0.052071
#*# 	  -0.035224, -0.037685, -0.032078, -0.028156, -0.020181, 0.000100, 0.027032, 0.048958, 0.049341, 0.031554, 0.003698, -0.015415, -0.011321, -0.000680, 0.002626, 0.003579, 0.003690, 0.008138, 0.012272, 0.021629, 0.029034, 0.015379, -0.002295, -0.013214, -0.017869, -0.034119, -0.057453, -0.073164, -0.069646, -0.051200
#*# 	  -0.036798, -0.037254, -0.030979, -0.027215, -0.017306, 0.002644, 0.033858, 0.052271, 0.050854, 0.030733, 0.000064, -0.020173, -0.013443, 0.000920, 0.004028, 0.005139, 0.005184, 0.009988, 0.011690, 0.019280, 0.027143, 0.017491, 0.000306, -0.007762, -0.011226, -0.028530, -0.054183, -0.072318, -0.069635, -0.049165
#*# 	  -0.039594, -0.038770, -0.030438, -0.029225, -0.017417, 0.006061, 0.034077, 0.052345, 0.050608, 0.029418, 0.000048, -0.022554, -0.016430, -0.002635, 0.000806, 0.004022, 0.006823, 0.009646, 0.011811, 0.017393, 0.026311, 0.018054, 0.004760, -0.003095, -0.006846, -0.022837, -0.049201, -0.067590, -0.065024, -0.044665
#*# 	  -0.043697, -0.037009, -0.029955, -0.028216, -0.016446, 0.004740, 0.033075, 0.052097, 0.049590, 0.031441, -0.001009, -0.025555, -0.022294, -0.008153, 0.000286, 0.003498, 0.007302, 0.007933, 0.009821, 0.016316, 0.025725, 0.018450, 0.005706, 0.001049, -0.001319, -0.016588, -0.044719, -0.062206, -0.060081, -0.040057
#*# 	  -0.047645, -0.040392, -0.030391, -0.029212, -0.019544, 0.001751, 0.028631, 0.046600, 0.044811, 0.026656, -0.003561, -0.027377, -0.028789, -0.013023, -0.002406, 0.004747, 0.004624, -0.000035, 0.001169, 0.011675, 0.023262, 0.017430, 0.005869, 0.001103, -0.000758, -0.014335, -0.040557, -0.060351, -0.056395, -0.037640
#*# 	  -0.044226, -0.040825, -0.032387, -0.028683, -0.018273, -0.001665, 0.024752, 0.042658, 0.039517, 0.021461, -0.005484, -0.030038, -0.029401, -0.017573, -0.003682, 0.004768, 0.000175, -0.006441, -0.004450, 0.010154, 0.021561, 0.015128, 0.004390, -0.000443, 0.000846, -0.010187, -0.037474, -0.058143, -0.053714, -0.039578
#*# 	  -0.048712, -0.046205, -0.040754, -0.033461, -0.023983, -0.007515, 0.017705, 0.034832, 0.032675, 0.015705, -0.008116, -0.027983, -0.028726, -0.019759, -0.011351, -0.003886, -0.007064, -0.012033, -0.010284, 0.004716, 0.017020, 0.010664, -0.001146, -0.003388, -0.000638, -0.010108, -0.036253, -0.057261, -0.056049, -0.045120
#*# 	  -0.050665, -0.052665, -0.045637, -0.040485, -0.029269, -0.014986, 0.010719, 0.029097, 0.029361, 0.015060, -0.006495, -0.025105, -0.022325, -0.013633, -0.010084, -0.006399, -0.008572, -0.011569, -0.007109, 0.007244, 0.018448, 0.010812, -0.004224, -0.007715, -0.000179, -0.006671, -0.034458, -0.054917, -0.058223, -0.051051
#*# 	  -0.061335, -0.059064, -0.053277, -0.047195, -0.037291, -0.020462, 0.005229, 0.025380, 0.028879, 0.017180, -0.002068, -0.017325, -0.013222, -0.005562, -0.004451, -0.004406, -0.006689, -0.007703, -0.003583, 0.008958, 0.020678, 0.011881, -0.003432, -0.007609, -0.000183, -0.005820, -0.029256, -0.052563, -0.057874, -0.056565
#*# 	  -0.063527, -0.061578, -0.054719, -0.050360, -0.040244, -0.022749, 0.003198, 0.024062, 0.031357, 0.023946, 0.005933, -0.007108, -0.002442, 0.005824, 0.007794, 0.002782, 0.001007, -0.002015, 0.000741, 0.015697, 0.025908, 0.015720, -0.003495, -0.008450, 0.000523, -0.002991, -0.028113, -0.047797, -0.056280, -0.058367
#*# 	  -0.062604, -0.062812, -0.059351, -0.057883, -0.046306, -0.026909, 0.000736, 0.022289, 0.032108, 0.026767, 0.011317, -0.000797, 0.002724, 0.011004, 0.010418, 0.008552, 0.004746, 0.000516, 0.002982, 0.015273, 0.024354, 0.011182, -0.006176, -0.011406, -0.005230, -0.009728, -0.029031, -0.046717, -0.056382, -0.062379
#*# 	  -0.058843, -0.060847, -0.057122, -0.056472, -0.046166, -0.025615, 0.001772, 0.025245, 0.035618, 0.031508, 0.016389, 0.005824, 0.008564, 0.015382, 0.014650, 0.010790, 0.007777, 0.002084, 0.003844, 0.015995, 0.023315, 0.009677, -0.009452, -0.012805, -0.007145, -0.011329, -0.029041, -0.043579, -0.050655, -0.058954
#*# 	  -0.063259, -0.062556, -0.057732, -0.059162, -0.048878, -0.028915, -0.000473, 0.023182, 0.033448, 0.028557, 0.014463, 0.001800, 0.004095, 0.011210, 0.006820, 0.003315, 0.000931, -0.003914, -0.002946, 0.010083, 0.020894, 0.008491, -0.004966, -0.014972, -0.012280, -0.018046, -0.034283, -0.045022, -0.050205, -0.057130
#*# 	  -0.059031, -0.060176, -0.054673, -0.055348, -0.046893, -0.028232, -0.002126, 0.021907, 0.032354, 0.025864, 0.012258, -0.002766, -0.002077, 0.003971, -0.001472, -0.005243, -0.004794, -0.009833, -0.007758, 0.008479, 0.019359, 0.008073, 0.004599, -0.005251, -0.004703, -0.016426, -0.036025, -0.044119, -0.047120, -0.053054
#*# 	  -0.054442, -0.054981, -0.047518, -0.047865, -0.040849, -0.023531, 0.001654, 0.024567, 0.034081, 0.026462, 0.012492, -0.001805, -0.004502, -0.001573, -0.008107, -0.011208, -0.009385, -0.011568, -0.008706, 0.008936, 0.025398, 0.020310, 0.010128, 0.008872, 0.001918, -0.012265, -0.032796, -0.042182, -0.042638, -0.047484
#*# 	  -0.042830, -0.041241, -0.034168, -0.033794, -0.029023, -0.013439, 0.007636, 0.028844, 0.038556, 0.030313, 0.018367, 0.000506, -0.004978, -0.005806, -0.014398, -0.019156, -0.017780, -0.016059, -0.007847, 0.010496, 0.032491, 0.033750, 0.017582, 0.011097, 0.008671, -0.003582, -0.024509, -0.035869, -0.038042, -0.040505
#*# 	  -0.036538, -0.033798, -0.024506, -0.022981, -0.017135, -0.001263, 0.018392, 0.033386, 0.035998, 0.029544, 0.020629, 0.004361, -0.003809, -0.008021, -0.020470, -0.024727, -0.018378, -0.011042, 0.002755, 0.020028, 0.035619, 0.033381, 0.022017, 0.017099, 0.014934, 0.004787, -0.016969, -0.030244, -0.033797, -0.038918
#*# 	  -0.029325, -0.024006, -0.015596, -0.011595, -0.006906, 0.007068, 0.028335, 0.046854, 0.047670, 0.023971, 0.006652, -0.005900, -0.008369, -0.009395, -0.016667, -0.020185, -0.017827, -0.008219, 0.007993, 0.029463, 0.045704, 0.040229, 0.035360, 0.028055, 0.018360, 0.010439, -0.008961, -0.020986, -0.026555, -0.031701
#*# x_count = 30
#*# y_count = 30
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 35.0
#*# max_x = 315.0
#*# min_y = 19.0
#*# max_y = 300.0
